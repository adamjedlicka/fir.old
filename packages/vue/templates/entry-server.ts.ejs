import { createSSRApp } from 'vue'
import { renderToString } from '@vue/server-renderer'
import App from './App.vue'

<%_ for (const [extension, path] of Object.entries(context.extensions)) { _%>
  import <%- extension -%> from '<%- path -%>'
  <%_ } _%>

export default async (ctx) => {
  const app = createSSRApp(App)

  <%_ for (const [extension] of Object.entries(context.extensions)) { _%>
  await <%- extension -%>(app, ctx)
  <%_ } _%>

  const html = await renderToString(app, ctx)

  return html
}
